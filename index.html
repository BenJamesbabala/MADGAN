<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Multi-Agent Diverse Generative Adversarial Networks</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-71335999-4', 'auto');
     ga('send', 'pageview');
      
    </script>
    <section class="page-header">
      <h1 class="project-name">Multi-Agent Diverse Generative Adversarial Networks</h1>
      <a href="https://arxiv.org/abs/1704.02906" class="btn" target="_blank">Link to Paper</a>
      <a href="https://github.com/arnabgho/MADGAN" class="btn" target="_blank">View on GitHub</a>
    </section>
    <section class="main-content">
      <h1>
<a id="multi-agent-diverse-generative-adversarial-networks" class="anchor" href="#multi-agent-diverse-generative-adversarial-networks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="https://arxiv.org/abs/1704.02906" target="_blank">Multi-Agent Diverse Generative Adversarial Networks</a></h1>

<p>Arnab Ghosh<sup>*</sup>, Viveka Kulharia<sup>*</sup>, Vinay Namboodiri, Philip H. S. Torr, Puneet K. Dokania</p>

<p><sup>*</sup>Equal contribution</p>

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/identify_real.jpg" width="560px"></p>

<p>As we can see from the Bags Generated by the 3 Generators, each of them seem highly artistic and designer quality.</p> 

<hr>

<h2>
<a id="the-crux" class="anchor" href="#the-crux" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Crux</h2>

<p><b>Why to employ Multiple Generators?</b>
<ul>
<li><p>As we can see from the 4 randomly sampled images from Imagenet below, the variations in the image samples is staggering.</p></li>
<li><p>As we have seen previously that single GANs (DCGAN) have experienced great success in modeling restricted domains of images such as celebrity faces and our motivation is to distribute the tasks of the generators so that they can master disjoint modes of the data distribution.</p></li>
</ul>
</p>

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/Imagent2x2.jpg" width="700px"></p>

<hr>

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/gan_architecture.png" width="700px"></p>

<p>In GANs the training signal for the Generator comes from the Discriminator. Hence the gradients from the Discriminator are attracted more by high density modes than the lower density modes. As shown in figure below, the generation manifold isnâ€™t able to master low density modes well.</p>  

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/generated_mode.png" width="700px"></p>

<p><b>Problems with naive modeling of multiple Generators:</b>
<ul>
<li><p>There is nothing to stop the different Generators from learning the same parts of the data distribution manifold.</p></li>
<li><p>Parameters would explode if the Generators share no information.</p></li>
</ul></p>

<hr>

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/Shared_MADGAN.png" width="700px"></p>

<p><b>The architecture.</b>
<ul>
<li><p>To ensure that the Generators are pushed towards distinct areas of the distribution manifold, we use diversity promoting objectives such as Generator Identification based Objective and Competing Objective.</p></li> 
<li><p>To avoid the problem of exploding parameters we share the parameters between the Generators except the last layer.</p></li>
</ul>
</p>

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/generated_multimodes.png" width="700px"></p>

<p>As shown in the figure above, even if the generation manifolds of the Generators G1 and G2 are close together, our formulation can master low density modes by diversity enforcing objectives.</p>

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/competing_objective_architecture.png" width="700px"></p>

<p><b>Model architecture with Competing Objective.</b>
<ul>
  <li><p>Discriminator output in traditional GANs score how real an image is.</p></li>
  <li><p>Competing Objective is forcing the generators to generate different kinds of images besides being real looking.</p></li>
</ul></p>     

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/generator_identification_architecture.png" width="700px"></p>

<p><b>Model architecture with Generator Identification based Objective.</b>
<ul>
  <li><p>Intuitively, the Discriminator has knowledge of the data distribution and we leverage that information to push the different Generators towards disjoint modes.</p></li>
  <li><p>We change the game a bit and ask the Discriminator to predict not only whether an image is real or fake but also if it's fake then which Generator produced it.</p></li>
  <li><p>Intuitively, to succeed in this task, since the gradients of the Generators come from the Discriminator it has to learn to push the different Generators towards different kinds of modes.</p></li>
</ul></p>  

<hr>

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/toy_input.png" width="350px" align="left"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/toy_gan.png" width="350px"></p>

<p>To show the efficacy of our method in toy datasets, we have 18 Gaussians arranged in 3 clusters and from one cluster less points were sampled to emulate the mode density imbalance situation. GAN (on the top-right) collapses all the modes and is not able to recover the data distribution while GAN with Batch Normalization (on the bottom-left) misses out the cluster from which less samples were sampled.
</p>     

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/toy_gan_bn.png" width="350px" align="left"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/toy_our.png" width="350px"></p>

<p>Our model (on the top-right) is able to capture most of the modes and as we can see from the different colors the different Generators master disjoint modes of the data distribution.</p>    

<hr>

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/day_compete_sum_score_5_p.png" width="350px" align="left"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/day_classifying_5_p.png" width="350px"></p>

<p>The figure top left is for Competing Objective while on top right is for Generator Identification based Objective. Diverse generations for 'night to day' image generation task. First column in each figure represents the input. The remaining three columns show the diverse outputs of different Generators. It is evident from that different Generators are able to produce very diverse results capturing different lighting conditions, different sky patterns (cloudy vs clear sky), different weather conditions (winter, summer, rain), different landscapes, among many other minute yet useful cues.</p>    


<hr>

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/bags_compete_5_p.png" width="700px"></p>

<p>The figure on top is for Competing Objective while the bottom one is for Generator Identification based Objective. Diverse generations for 'sketch-bag to real-bag' generation task. The first column in each figure represents the input. The remaining three columns show the diverse outputs of different Generators. It is evident from it that different Generators are able to produce very diverse results capturing different colors (blue, green, black etc), textures (leather, fabric, plastic etc), design patterns, among others.</p>  

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/bags_classifying_5_p.png" width="700px"></p>

<hr>

<p style="text-align:center;"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/dcgan_faces_compete.png" width="350px" align="left"><img src="https://raw.githubusercontent.com/arnabgho/MADGAN/master/images/dcgan_faces_classifying.png" width="350px"></p>

<p>The left figure corresponds to Competing Objective. Here the first Generator generates as expected by the DC-GAN, while the second Generator generates with high detailing of the faces and exaggerated facial features, and the third Generator generates images with sketch like quality with an artistic touch. The right figure corresponds to Generator Identification based Objective. Here, the first Generator is generating faces as the normal DC-GAN architecture would. The second Generator is generating faces like oil-paintings, while the third Generator seems to be generating images with coarse strokes without much focus on the background</p> 

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/arnabgho/MADGAN"  target="_blank">Multi-Agent Diverse Generative Adversarial Networks</a> is maintained by <a href="https://github.com/arnabgho"  target="_blank">arnabgho</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com"  target="_blank">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme"  target="_blank">Cayman theme</a> by <a href="https://twitter.com/jasonlong"  target="_blank">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
